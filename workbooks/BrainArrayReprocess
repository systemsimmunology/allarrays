
June 3-8, 2010
------------

Reprocess exon arrays with new 2hr triplicate

On romulus:
arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/LPSexonCelFiles_unix "MoEx10stv1_Mm_ENTREZG" ~/allarrays/processed_data ~/allarrays/tmp

Copy files in processed_data to data/20100407.curated.exon

We're missing the Probeset column header (again?) so insert by hand

cd data/20100407.curated.exon 
 R --vanilla --slave --args emat.tsv $AA/auxfiles/LPSexonCelFiles-groupings.tsv eemat.tsv  < $AA/arraypipeline/median_combine_replicates.R

Sample groups, RData files
cd data/20100407.curated.exon 
R --slave --args ../../auxfiles/LPSexonCelFiles-GroupMetaData.tsv < ../../utils/ReadSampleGroup.R 

~/bin/reMap.py eemat.tsv 1 MoEx10stv1_Mm_ENTREZG_mapfile 1 2 > expmat.tsv
R --vanilla --slave < $AA/utils/ExpmatToDM.R 

May 4, 2010
------------
Need to re-assess lambda cutoff

go to tmp directory. Turn off rm -f * in scripts.

grep 0000 $AA/auxfiles/ThreePrimeMasterFile.tsv | awk '{OFS="\t"; print $3,$2}' > tempfile
Edit to yield only triplicated 
mv tempfile unstim-groupings.tsv

../VERASAMpipeline.sh $AA/data/20100426.curated.3prime/emat.tsv unstim-groupings.tsv BMDM_Bl6_LPS_0000___Female

May 1, 2010
-----------
run in a tmp folder
../NonRepPipeline.sh /Users/thorsson/allarrays/data/20100426.curated.3prime/emat.tsv
mv -f *.mus $AA/data/20100426.curated.3prime

cd $AA/annotations
awk '{print $1}' $AA/data/20100426.curated.3prime/emat.tsv | tail +2 > MoGene4302_Mm_ENTREZG_psid
sed 's/\_at//g' MoGene4302_Mm_ENTREZG_psid > MoGene4302_Mm_ENTREZG_eid
~/bin/reMap.py MoGene4302_Mm_ENTREZG_eid 1 ~/data/ncbi/gene_info_simplified_mouse 1 2 > MoGene4302_Mm_ENTREZG_symbol
paste MoGene4302_Mm_ENTREZG_psid MoGene4302_Mm_ENTREZG_eid MoGene4302_Mm_ENTREZG_symbol > MoGene4302_Mm_ENTREZG_mapfile 
echo -e 'ProbesetID\tEntrezID\tGeneSymbol' | cat - MoGene4302_Mm_ENTREZG_mapfile  > tempfile
mv -f tempfile MoGene4302_Mm_ENTREZG_mapfile
rm -f MoGene4302_Mm_ENTREZG_psid MoGene4302_Mm_ENTREZG_eid MoGene4302_Mm_ENTREZG_symbol

April 27, 2010
--------------
R --no-save < /Users/thorsson/allarrays/arraypipeline/SetUpThreePrime.R
../VERASAMpipelineWrapperThreePrime.sh

April 27, 2010
--------------

grep PAM3 celfiles_no_path > $AA/auxfiles/PAM3threePrimeCelFiles-groupings.tsv

These were not in earlier analysis and were left out for now
20070307_05_WT_PAM3_8hr_2.CEL
20070307_04_WT_PAM3_8hr_1.CEL

$AA/arraypipeline/VERASAMpipeline.sh $AA/data/20100426.curated.3prime/emat.tsv $AA/auxfiles/PAM3threePrimeCelFiles-groupings.tsv BMDM_Bl6_PAM3_0000

cp expression.mus /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM3.mus
cp expression.log10_ratios /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM3.log10_ratios
cp expression.lambdas /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM3.lambdas      
cp expression.muStandardErrors /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM3.muStandardErrors

April 26, 2010
--------------

Get ProbesetID into top left corner
cat ProbesetIDString $AA/data/20100426.curated.3prime/emat.tsv > tempfile
 mv tempfile $AA/data/20100426.curated.3prime/emat.tsv


cp ../data/20100426.curated.3prime/celfiles_no_path .

grep PAM2 celfiles_no_path > $AA/auxfiles/PAM2threePrimeCelFiles-groupings.tsv

edit PAM2threePrimeCelFiles-groupings.tsv

In any directory do

$AA/arraypipeline/VERASAMpipeline.sh $AA/data/20100426.curated.3prime/emat.tsv $AA/auxfiles/PAM2threePrimeCelFiles-groupings.tsv BMDM_Bl6_PAM2_0000___Female

cp expression.mus /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM2.mus
cp expression.log10_ratios /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM2.log10_ratios
cp expression.lambdas /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM2.lambdas      
cp expression.muStandardErrors /Users/thorsson/allarrays/data/20100426.curated.3prime/PAM2.muStandardErrors


grep PAM3 celfiles_no_path > $AA/auxfiles/PAM3threePrimeCelFiles-groupings.tsv

April 23, 2010
--------------

In auxfiles

MyD88 KO
ls /net/arrays/Affymetrix/core/probe_data/200502/*CEL | grep MyD88 | grep "\-0" > tempfile
ls $NAP/200502/*CEL | grep MyD88 | grep "\-0" > tempfile

cat tempfile MyD88LPSthreePrimeCelFiles_unix MyD88PAM3threePrimeCelFiles_unix MyD88PolyICthreePrimeCelFiles_unix > MyD88threePrimeCelFiles_unix
rm -f tempfile

cat TRIFLPSthreePrimeCelFiles_unix TRIFPAM2threePrimeCelFiles_unix > TRIFthreePrimeCelFiles_unix

cat LPSthreePrimeCelFiles_unix PAM2threePrimeCelFiles_unix PAM3threePrimeCelFiles_unix PolyICthreePrimeCelFiles_unix R848threePrimeCelFiles_unix CpGthreePrimeCelFiles_unix MyD88threePrimeCelFiles_unix TRIFthreePrimeCelFiles_unix > OriginalThreePrimeCelFiles_unix

Normalize all 

arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/OriginalThreePrimeCelFiles_os_x "Mouse4302_Mm_ENTREZG" ~/allarrays/data ~/allarrays/tmp >& OriginalThreePrime.logfile & 


April 21, 2010
--------------

In any directory do
../VERASAMpipeline.sh $HOME/allarrays/data/20100407.curated.3prime/emat.tsv /Users/thorsson/allarrays/auxfiles/LPSthreePrimeCelFiles-groupings.tsv BMDM_Bl6_LPS_0000___Female
cp expression.mus /Users/thorsson/allarrays/data/20100407.curated.3prime/LPS.mus
cp expression.log10_ratios /Users/thorsson/allarrays/data/20100407.curated.3prime/LPS.log10_ratios
cp expression.lambdas /Users/thorsson/allarrays/data/20100407.curated.3prime/LPS.lambdas      
cp expression.muStandardErrors /Users/thorsson/allarrays/data/20100407.curated.3prime/LPS.muStandardErrors


April 20, 2010
--------------

We will need to be getting rid of AFFX probes

Line number of first AFFX probe

cat -n emat.tsv | grep AFFX | awk '{print $1}' | head -1

head -16332 emat.tsv  > tempfile
mv -f tempfile emat.tsv 

April 12, 2010
--------------

Exon array Replicate combination. 

cd data/20100407.curated.exon 
 R --vanilla --slave --args emat.tsv $AA/auxfiles/LPSexonCelFiles-groupings.tsv eemat.tsv  < $AA/arraypipeline/median_combine_replicates.R

Sample groups, RData files
cd data/20100407.curated.exon 
R --slave --args ../../auxfiles/LPSexonCelFiles-GroupMetaData.tsv < ../../utils/ReadSampleGroup.R 

cd data/20100407.curated.3prime
R --slave --args ../../auxfiles/LPSthreePrimeCelFiles-GroupMetaData.tsv < ../../utils/ReadSampleGroup.R  

April 7, 2010
-------------

cd data/20100407.curated.exon 
R --slave --args ../../auxfiles/LPSexonCelFiles-GroupMetaData.tsv < ../../utils/ReadSampleGroup.R
awk '{print $1}' eemat.tsv | tail +2 > MoEx10stv1_Mm_ENTREZG_psid
awk '{print $1}' eemat.tsv | sed 's/\_at//g' | tail +2 > MoEx10stv1_Mm_ENTREZG_eid
paste MoEx10stv1_Mm_ENTREZG_psid MoEx10stv1_Mm_ENTREZG_eid > MoEx10stv1_Mm_ENTREZG_mapfile
Insert this header by and for now
ProbesetID      EntrezID
*** Need to have non-zero upper left in eemat matrix for this to work. Inserted ProbesetID by hand for now
~/bin/reMap.py eemat.tsv 1 MoEx10stv1_Mm_ENTREZG_mapfile 1 2 > expmat.tsv
R --vanilla --slave < $AA/utils/ExpmatToDM.R 

cd data/20100407.curated.3prime
R --slave --args ../../auxfiles/LPSthreePrimeCelFiles-GroupMetaData.tsv < ../../utils/ReadSampleGroup.R
awk '{print $1}' eemat.tsv | tail +2 > MoGene4302_Mm_ENTREZG_psid
awk '{print $1}' eemat.tsv | sed 's/\_at//g' | tail +2 > MoGene4302_Mm_ENTREZG_eid
paste MoGene4302_Mm_ENTREZG_psid MoGene4302_Mm_ENTREZG_eid > MoGene4302_Mm_ENTREZG_mapfile
Insert this header by and for now
ProbesetID      EntrezID
*** Need to have non-zero upper left in matrix for this to work. Inserted ProbesetID by hand for now
~/bin/reMap.py eemat.tsv 1 MoGene4302_Mm_ENTREZG_mapfile 1 2 > expmat.tsv
R --vanilla --slave < ../../utils/ExpmatToDM.R 

April 6, 2010
-------------

cd $AA/processed_data/LPSExon
awk '{print $1}' eemat.tsv | sed 's/\_at//g' | tail +2 > MoGene10stv1_Mm_ENTREZG_eid
## might be better to get that from bioconductor
~/bin/reMap.py MoGene10stv1_Mm_ENTREZG_eid 1 ~/data/ncbi/gene_info_simplified_mouse 1 2 > MoGene10stv1_Mm_ENTREZG_symbol

cd $AA/processed_data/LPSThreePrime
awk '{print $1}' eemat.tsv | sed 's/\_at//g' | tail +2 > MoGene4302_Mm_ENTREZG_eid
## might be better to get that from bioconductor
~/bin/reMap.py MoGene4302_Mm_ENTREZG_eid 1 ~/data/ncbi/gene_info_simplified_mouse 1 2 > MoGene4302_Mm_ENTREZG_symbol
Includes 64 AFFX

Replicate combination

R --vanilla --slave --args $AA/processed_data/LPSThreePrime/emat.tsv $AA/auxfiles/LPSthreePrimeCelFiles-groupings.tsv $AA/processed_data/LPSThreePrime/eemat.tsv  < median_combine_replicates.R

R --vanilla --slave --args $AA/processed_data/LPSExon/emat.tsv $AA/auxfiles/LPSexonCelFiles-groupings.tsv $AA/processed_data/LPSExon/eemat.tsv  < median_combine_replicates.R


April 5, 2010
-------------

******Normalization*************

On unix machine

arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/LPSthreePrimeCelFiles_unix "Mouse4302_Mm_ENTREZG" ~/allarrays/processed_data ~/allarrays/tmp 

arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/LPSexonCelFiles_unix "MoEx10stv1_Mm_ENTREZG" ~/allarrays/processed_data ~/allarrays/tmp

On os x  machine

arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/LPSthreePrimeCelFiles_OS_X "Mouse4302_Mm_ENTREZG" ~/allarrays/processed_data ~/allarrays/tmp 

arraypipeline/normalize_and_probeset_summarize.sh ~/allarrays/auxfiles/LPSexonCelFiles_unix "MoEx10stv1_Mm_ENTREZG" ~/allarrays/processed_data ~/allarrays/tmp

